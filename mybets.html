<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Bets | Edge Factor Elite</title>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #0a0a0f;
      --bg-secondary: #111118;
      --bg-tertiary: #1a1a24;
      --bg-elevated: rgba(37, 37, 50, 0.5);
      --border: rgba(255, 255, 255, 0.08);
      --border-light: rgba(255, 255, 255, 0.12);
      --text-primary: #f0f0f0;
      --text-secondary: #9ca3af;
      --text-muted: #6b7280;
      --brand: #dc2626;
      --brand-light: #ef4444;
      --brand-glow: rgba(220, 38, 38, 0.15);
      --brand-border: rgba(220, 38, 38, 0.3);
      --accent: #10b981;
      --accent-light: #34d399;
      --accent-glow: rgba(16, 185, 129, 0.15);
      --red: #ef4444;
      --red-light: #f87171;
      --yellow: #f59e0b;
      --blue: #3b82f6;
      --purple: #8b5cf6;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary); color: var(--text-primary);
      line-height: 1.6; -webkit-font-smoothing: antialiased;
    }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: var(--bg-primary); }
    ::-webkit-scrollbar-thumb { background: #2a2a3a; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #3a3a4a; }
    .page-gradient {
      position: fixed; top: 0; left: 0; right: 0; height: 60vh;
      background: radial-gradient(ellipse 80% 50% at 50% -20%, rgba(220,38,38,0.08), transparent);
      pointer-events: none; z-index: 0;
    }

    /* ── Top Nav ── */
    .top-nav { background: var(--bg-primary); position: fixed; top: 0; left: 0; right: 0; height: 60px; z-index: 100; display: flex; align-items: center; }
    .top-nav-inner { position: relative; max-width: 1400px; margin: 0 auto; padding: 0 1.5rem; width: 100%; height: 100%; display: flex; align-items: center; justify-content: space-between; }
    .nav-brand { position: relative; z-index: 2; }
    .sports-tabs { display: flex; align-items: center; gap: 4px; background: var(--bg-tertiary); border-radius: 10px; padding: 4px; position: absolute; left: 50%; transform: translateX(-50%); z-index: 1; }
    .sport-tab { position: relative; padding: 6px 18px; border-radius: 8px; border: none; background: transparent; color: var(--text-muted); font-size: 13px; font-weight: 600; font-family: inherit; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 6px; }
    .sport-tab:hover { color: var(--text-secondary); }
    .sport-tab.active { background: var(--brand); color: #fff; box-shadow: 0 2px 8px rgba(220,38,38,0.3); }
    .soon-badge { font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; padding: 1px 5px; border-radius: 4px; background: rgba(255,255,255,0.1); color: var(--text-muted); }
    .sport-tab.active .soon-badge { display: none; }
    .nav-right { display: flex; align-items: center; gap: 1.5rem; flex: 0 0 auto; position: relative; z-index: 2; }
    .nav-link { color: #a0a0a0; text-decoration: none; font-size: 0.9rem; transition: color 0.2s; font-weight: 500; }
    .nav-link:hover { color: #fff; }
    .nav-link.active { color: #fff; }
    .mobile-menu-btn { display: none; background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; }
    .bet-count-badge { background: var(--accent); color: #fff; font-size: 10px; padding: 1px 5px; border-radius: 8px; margin-left: 4px; vertical-align: middle; }
    .login-btn-pill { padding: 8px 20px; background: linear-gradient(135deg, #00c853, #00e676); color: #0a0e1a; border-radius: 20px; font-weight: 600; font-size: 14px; transition: transform 0.2s, box-shadow 0.2s; display: inline-block; }
    .login-btn-pill:hover { transform: translateY(-1px); box-shadow: 0 4px 15px rgba(0,200,83,0.3); }

    /* ── User Menu & Avatar ── */
    .user-menu { position: relative; }
    .user-avatar { width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, #00c853, #00e676); color: #0a0e1a; font-weight: 700; font-size: 16px; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: transform 0.2s; }
    .user-avatar:hover { transform: scale(1.1); }
    .user-dropdown { position: absolute; top: calc(100% + 8px); right: 0; background: #1a1f2e; border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; min-width: 200px; padding: 8px 0; display: none; z-index: 1000; box-shadow: 0 8px 32px rgba(0,0,0,0.4); }
    .user-dropdown.active { display: block; }
    .dropdown-header { padding: 12px 16px; border-bottom: 1px solid rgba(255,255,255,0.1); }
    .dropdown-header .user-name { display: block; font-weight: 600; color: #fff; font-size: 14px; }
    .dropdown-header .user-email { display: block; color: rgba(255,255,255,0.5); font-size: 12px; margin-top: 2px; }
    .dropdown-header .user-role { display: inline-block; margin-top: 6px; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; background: rgba(0,200,83,0.15); color: #00c853; }
    .dropdown-divider { height: 1px; background: rgba(255,255,255,0.1); margin: 4px 0; }
    .dropdown-item { display: block; padding: 10px 16px; color: rgba(255,255,255,0.8); text-decoration: none; font-size: 14px; transition: background 0.2s; }
    .dropdown-item:hover { background: rgba(255,255,255,0.05); color: #fff; }

    /* ── Mobile Drawer ── */
    .mobile-nav-backdrop { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 9998; }
    .mobile-nav-backdrop.open { display: block; }
    .mobile-nav-drawer { position: fixed; top: 90px; left: 0; right: 0; background: #1a1a24; border-bottom: 2px solid #2a2a3a; z-index: 9999; overflow: hidden; max-height: 0; transition: max-height 0.3s ease; box-shadow: 0 8px 32px rgba(0,0,0,0.5); }
    .mobile-nav-drawer.open { max-height: 500px; }
    .mobile-drawer-links a { display: flex; align-items: center; gap: 12px; padding: 14px 24px; color: #fff; text-decoration: none; font-size: 16px; font-weight: 500; border-bottom: 1px solid #2a2a3a; transition: all 0.15s; }
    .mobile-drawer-links a:hover, .mobile-drawer-links a.active { color: #dc2626; background: rgba(220,38,38,0.08); }
    .mobile-drawer-links a .menu-icon { font-size: 18px; width: 24px; text-align: center; flex-shrink: 0; }
    .mobile-drawer-auth { padding: 12px 24px 16px; }
    .mobile-drawer-profile { display: flex; align-items: center; gap: 12px; padding: 10px 0 14px; }
    .mobile-drawer-avatar { width: 40px; height: 40px; border-radius: 50%; background: #dc2626; color: white; font-size: 16px; font-weight: 700; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
    .mobile-drawer-user-info { display: flex; flex-direction: column; gap: 2px; min-width: 0; }
    .mobile-drawer-name { font-size: 15px; font-weight: 600; color: #f0f0f0; }
    .mobile-drawer-email { font-size: 12px; color: #6b7280; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .mobile-drawer-login-btn { display: block; width: 100%; padding: 12px; background: #dc2626; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; text-align: center; text-decoration: none; transition: background 0.15s; }
    .mobile-drawer-login-btn:hover { background: #b91c1c; }

    /* ── Kill ALL stray borders/lines on nav and structural elements ── */
    html, body,
    header, nav, main, section, footer,
    .top-nav, .top-nav *,
    .nav-spacer,
    .page-gradient,
    .page-header, .page-title,
    .mobile-nav-backdrop, .mobile-nav-drawer, .mobile-nav-drawer * {
      border-top: none !important;
      border-bottom: none !important;
      box-shadow: none !important;
    }
    /* Restore intentional borders that the nuclear rule removes */
    .mobile-nav-drawer { border-bottom: 2px solid #2a2a3a !important; }
    .mobile-drawer-links a { border-bottom: 1px solid #2a2a3a !important; }
    .dropdown-header { border-bottom: 1px solid rgba(255,255,255,0.1) !important; }
    .user-dropdown { border: 1px solid rgba(255,255,255,0.1) !important; box-shadow: 0 8px 32px rgba(0,0,0,0.4) !important; }
    .sport-tab.active { box-shadow: 0 2px 8px rgba(220,38,38,0.3) !important; }
    footer { border-top: 1px solid var(--border) !important; }

    .nav-spacer { height: 70px; }

    /* ── Page Title ── */
    .page-header { max-width: 960px; margin: 0 auto 24px; padding: 0 24px; }
    .page-title { font-size: 22px; font-weight: 800; letter-spacing: -0.02em; display: flex; align-items: center; gap: 10px; }
    .page-title::before { content: ''; width: 4px; height: 22px; background: var(--brand); border-radius: 2px; }

    /* ── Main ── */
    main { max-width: 960px; margin: 0 auto; padding: 0 24px 80px; position: relative; z-index: 1; }

    /* ── Fade-in animation ── */
    @keyframes fadeUp { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
    .fade-section { animation: fadeUp 0.4s ease both; }
    .fade-section:nth-child(2) { animation-delay: 0.05s; }
    .fade-section:nth-child(3) { animation-delay: 0.1s; }
    .fade-section:nth-child(4) { animation-delay: 0.15s; }
    .fade-section:nth-child(5) { animation-delay: 0.2s; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

    /* ── Overview Banner ── */
    .overview-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 24px; }
    .ov-card {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(26,26,36,0.8) 100%);
      border: 1px solid var(--border); border-radius: 12px; padding: 18px 16px;
      position: relative; overflow: hidden; border-left: 3px solid var(--border-light);
    }
    .ov-card::after {
      content: ''; position: absolute; top: 0; right: 0; width: 80px; height: 80px;
      border-radius: 50%; filter: blur(30px); pointer-events: none; opacity: 0.08;
    }
    .ov-card.profit { border-left-color: var(--accent); }
    .ov-card.profit::after { background: var(--accent); }
    .ov-card.profit.negative { border-left-color: var(--red); }
    .ov-card.profit.negative::after { background: var(--red); }
    .ov-card.rate { border-left-color: var(--blue); }
    .ov-card.rate::after { background: var(--blue); }
    .ov-card.count { border-left-color: var(--purple); }
    .ov-card.count::after { background: var(--purple); }
    .ov-card.dollar { border-left-color: var(--yellow); }
    .ov-card.dollar::after { background: var(--yellow); }
    .ov-value { font-size: 28px; font-weight: 800; line-height: 1.1; letter-spacing: -0.02em; }
    .ov-value.green { color: var(--accent-light); }
    .ov-value.red { color: var(--red-light); }
    .ov-label { font-size: 10px; font-weight: 600; letter-spacing: 0.08em; color: var(--text-muted); text-transform: uppercase; margin-top: 6px; }

    /* ── Controls Row ── */
    .controls-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; gap: 12px; flex-wrap: wrap; }
    .period-pills { display: flex; gap: 4px; }
    .period-pill {
      padding: 6px 16px; border-radius: 100px; border: 1px solid var(--border);
      background: transparent; color: var(--text-muted); font-size: 12px; font-weight: 600;
      font-family: inherit; cursor: pointer; transition: all 0.2s;
    }
    .period-pill:hover { border-color: var(--border-light); color: var(--text-secondary); }
    .period-pill.active { background: var(--brand-glow); border-color: var(--brand-border); color: var(--brand-light); }
    .controls-right { display: flex; align-items: center; gap: 10px; }
    .pill-toggle {
      display: flex; background: var(--bg-tertiary); border-radius: 8px; padding: 3px; gap: 2px;
    }
    .pill-toggle-btn {
      padding: 5px 14px; border-radius: 6px; border: none; background: transparent;
      color: var(--text-muted); font-size: 12px; font-weight: 600; font-family: inherit;
      cursor: pointer; transition: all 0.2s;
    }
    .pill-toggle-btn.active { background: var(--bg-secondary); color: var(--text-primary); box-shadow: 0 1px 4px rgba(0,0,0,0.3); }
    /* ── Calendar Hero ── */
    .calendar-card {
      background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 16px;
      padding: 24px; margin-bottom: 24px;
    }
    .cal-header { display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 20px; }
    .cal-nav {
      background: none; border: 1px solid var(--border); color: var(--text-muted);
      width: 32px; height: 32px; border-radius: 8px; cursor: pointer; font-size: 12px;
      display: flex; align-items: center; justify-content: center; transition: all 0.2s;
    }
    .cal-nav:hover { border-color: var(--brand-border); color: var(--text-primary); }
    .cal-month { font-size: 18px; font-weight: 700; min-width: 180px; text-align: center; letter-spacing: -0.01em; }
    .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; }
    .cal-dow {
      text-align: center; font-size: 10px; font-weight: 700; color: var(--text-muted);
      text-transform: uppercase; letter-spacing: 0.1em; padding: 0 0 8px;
    }
    .cal-cell {
      position: relative; border-radius: 10px; display: flex; flex-direction: column;
      align-items: center; justify-content: center; cursor: pointer;
      transition: all 0.15s; border: 1.5px solid transparent;
      background: rgba(255,255,255,0.02); aspect-ratio: 1; overflow: hidden;
    }
    .cal-cell.empty { cursor: default; background: transparent; }
    .cal-cell .c-day { font-size: 11px; font-weight: 500; color: var(--text-muted); position: absolute; top: 4px; left: 6px; }
    .cal-cell .c-pl { font-size: 14px; font-weight: 800; letter-spacing: -0.02em; margin-top: 2px; }
    .cal-cell .c-dot { width: 4px; height: 4px; border-radius: 50%; position: absolute; bottom: 5px; }
    .cal-cell.future { opacity: 0.3; }
    .cal-cell.no-bets { background: rgba(255,255,255,0.015); }
    .cal-cell.win { background: linear-gradient(135deg, rgba(16,185,129,0.08) 0%, rgba(16,185,129,0.18) 100%); }
    .cal-cell.win .c-pl { color: var(--accent-light); }
    .cal-cell.win .c-dot { background: var(--accent); }
    .cal-cell.win-strong { background: linear-gradient(135deg, rgba(16,185,129,0.15) 0%, rgba(16,185,129,0.35) 100%); }
    .cal-cell.win-strong .c-pl { color: #6ee7b7; }
    .cal-cell.win-strong .c-dot { background: var(--accent-light); }
    .cal-cell.loss { background: linear-gradient(135deg, rgba(239,68,68,0.08) 0%, rgba(239,68,68,0.18) 100%); }
    .cal-cell.loss .c-pl { color: var(--red-light); }
    .cal-cell.loss .c-dot { background: var(--red); }
    .cal-cell.loss-strong { background: linear-gradient(135deg, rgba(239,68,68,0.15) 0%, rgba(239,68,68,0.35) 100%); }
    .cal-cell.loss-strong .c-pl { color: #fca5a5; }
    .cal-cell.loss-strong .c-dot { background: var(--red-light); }
    .cal-cell.push-day { background: rgba(245,158,11,0.08); }
    .cal-cell.push-day .c-pl { color: var(--yellow); }
    .cal-cell.push-day .c-dot { background: var(--yellow); }
    .cal-cell.pending-day { background: rgba(245,158,11,0.06); }
    .cal-cell.pending-day .c-pl { color: var(--text-muted); }
    .cal-cell.today { border-color: var(--brand); box-shadow: 0 0 12px rgba(220,38,38,0.2); }
    .cal-cell.selected { border-color: rgba(255,255,255,0.5); box-shadow: 0 0 8px rgba(255,255,255,0.06); }
    .cal-cell:not(.empty):hover { transform: scale(1.06); z-index: 2; border-color: var(--border-light); }

    /* Calendar tooltip */
    .cal-cell .c-tip {
      display: none; position: absolute; bottom: calc(100% + 6px); left: 50%; transform: translateX(-50%);
      background: #1e1e2e; border: 1px solid var(--border-light); border-radius: 8px;
      padding: 6px 10px; font-size: 11px; white-space: nowrap; z-index: 10;
      box-shadow: 0 4px 16px rgba(0,0,0,0.5); pointer-events: none;
    }
    .cal-cell:hover .c-tip { display: block; }
    .c-tip-record { font-weight: 600; color: var(--text-primary); }
    .c-tip-pl { font-weight: 700; margin-left: 6px; }

    /* Calendar month summary */
    .cal-summary {
      margin-top: 16px; display: flex; align-items: center; justify-content: center;
      gap: 24px; flex-wrap: wrap;
    }
    .cal-summary-pl {
      font-size: 16px; font-weight: 700;
      padding: 8px 20px; background: var(--bg-tertiary); border-radius: 10px;
    }
    .cal-winrate-bar {
      display: flex; align-items: center; gap: 8px;
    }
    .cal-winrate-track {
      width: 120px; height: 6px; background: rgba(239,68,68,0.3); border-radius: 3px; overflow: hidden;
    }
    .cal-winrate-fill { height: 100%; background: var(--accent); border-radius: 3px; transition: width 0.4s ease; }
    .cal-winrate-label { font-size: 12px; font-weight: 600; color: var(--text-secondary); }

    /* ── Day Detail ── */
    .day-section { margin-bottom: 24px; }
    .day-header {
      display: flex; align-items: center; justify-content: space-between; margin-bottom: 14px;
    }
    .day-title { font-size: 15px; font-weight: 700; display: flex; align-items: center; gap: 8px; }
    .day-title::before { content: ''; width: 3px; height: 14px; background: var(--brand); border-radius: 2px; }
    .day-record-badge {
      display: inline-flex; align-items: center; gap: 6px;
      padding: 4px 12px; border-radius: 100px; font-size: 12px; font-weight: 600;
      background: var(--bg-tertiary); color: var(--text-secondary);
    }
    .day-record-badge .drb-pl { font-weight: 700; }
    .day-record-badge .drb-pl.green { color: var(--accent-light); }
    .day-record-badge .drb-pl.red { color: var(--red-light); }

    /* Bet cards */
    .bet-card {
      background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 12px;
      padding: 14px 16px; margin-bottom: 8px; border-left: 3px solid var(--border);
      transition: background 0.15s; position: relative;
    }
    .bet-card:hover { background: var(--bg-elevated); }
    .bet-card.win { border-left-color: var(--accent); }
    .bet-card.loss { border-left-color: var(--red); }
    .bet-card.pending { border-left-color: var(--yellow); }
    .bet-card.push { border-left-color: var(--text-muted); }
    .bc-top { display: flex; align-items: flex-start; justify-content: space-between; gap: 12px; }
    .bc-left { flex: 1; min-width: 0; }
    .bc-player-row { display: flex; align-items: center; gap: 8px; margin-bottom: 4px; }
    .bc-icon { font-size: 16px; flex-shrink: 0; }
    .bc-player { font-size: 15px; font-weight: 700; }
    .bc-pick { font-size: 13px; color: var(--text-secondary); display: flex; align-items: center; gap: 6px; }
    .bc-pick .bc-sep { color: var(--text-muted); }
    .bc-meta { font-size: 12px; color: var(--text-muted); margin-top: 4px; display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
    .bc-meta-tag { background: rgba(255,255,255,0.04); padding: 2px 7px; border-radius: 4px; }
    .bc-right { text-align: right; flex-shrink: 0; }
    .bc-profit { font-size: 18px; font-weight: 800; letter-spacing: -0.02em; }
    .bc-profit.green { color: var(--accent-light); }
    .bc-profit.red { color: var(--red-light); }
    .bc-profit.yellow { color: var(--yellow); }
    .bc-dollar { font-size: 12px; color: var(--text-muted); font-weight: 500; }
    .bc-delete {
      position: absolute; top: 10px; right: 10px; background: none; border: none;
      color: var(--text-muted); cursor: pointer; font-size: 13px; padding: 4px 6px;
      border-radius: 6px; opacity: 0; transition: all 0.15s;
    }
    .bet-card:hover .bc-delete { opacity: 0.5; }
    .bc-delete:hover { opacity: 1 !important; color: var(--red); background: rgba(239,68,68,0.08); }
    .pending-dot {
      display: inline-block; width: 6px; height: 6px; border-radius: 50%;
      background: var(--yellow); margin-right: 4px; animation: pulse 2s ease-in-out infinite;
    }

    /* Empty states */
    .empty-state {
      text-align: center; padding: 48px 24px;
      background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 16px;
    }
    .empty-icon { font-size: 48px; margin-bottom: 12px; }
    .empty-title { font-size: 18px; font-weight: 700; margin-bottom: 6px; }
    .empty-text { font-size: 14px; color: var(--text-muted); margin-bottom: 20px; }
    .empty-cta {
      display: inline-block; padding: 10px 24px;
      background: linear-gradient(135deg, var(--brand) 0%, #991b1b 100%);
      color: #fff; border-radius: 8px; font-size: 14px; font-weight: 600;
      text-decoration: none; transition: opacity 0.15s;
    }
    .empty-cta:hover { opacity: 0.85; }
    .empty-day-msg { text-align: center; padding: 28px; color: var(--text-muted); font-size: 13px; }

    /* ── Analytics ── */
    .analytics-section { margin-bottom: 24px; }
    .section-title {
      font-size: 14px; font-weight: 600; color: var(--text-primary);
      display: flex; align-items: center; gap: 8px; margin-bottom: 16px;
    }
    .section-title::before { content: ''; width: 3px; height: 16px; background: var(--brand); border-radius: 2px; }
    .analytics-tabs { display: flex; gap: 4px; margin-bottom: 16px; }
    .analytics-tab {
      padding: 7px 18px; border-radius: 100px; border: 1px solid var(--border);
      background: transparent; color: var(--text-muted); font-size: 12px;
      font-weight: 600; font-family: inherit; cursor: pointer; transition: all 0.2s;
    }
    .analytics-tab:hover { border-color: var(--border-light); color: var(--text-secondary); }
    .analytics-tab.active { background: var(--bg-tertiary); border-color: var(--border-light); color: var(--text-primary); }
    .analytics-card {
      background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 12px; overflow: hidden;
    }
    .an-row {
      display: flex; align-items: center; padding: 12px 16px;
      border-bottom: 1px solid var(--border); gap: 12px;
    }
    .an-row:last-child { border-bottom: none; }
    .an-label { font-size: 13px; font-weight: 600; color: var(--text-primary); min-width: 100px; }
    .an-record { font-size: 12px; color: var(--text-muted); min-width: 60px; }
    .an-bar-wrap { flex: 1; display: flex; align-items: center; gap: 8px; }
    .an-bar-track { flex: 1; height: 8px; background: rgba(239,68,68,0.15); border-radius: 4px; overflow: hidden; min-width: 80px; }
    .an-bar-fill { height: 100%; background: linear-gradient(90deg, var(--accent) 0%, var(--accent-light) 100%); border-radius: 4px; transition: width 0.4s ease; }
    .an-pct { font-size: 12px; font-weight: 700; color: var(--text-secondary); min-width: 38px; }
    .an-pl { font-size: 13px; font-weight: 700; min-width: 60px; text-align: right; }
    .an-pl.positive { color: var(--accent-light); }
    .an-pl.negative { color: var(--red-light); }

    /* ── Settings ── */
    .settings-section {
      background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 12px;
      padding: 20px; margin-bottom: 24px;
    }
    .settings-row {
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 0; border-bottom: 1px solid var(--border);
    }
    .settings-row:last-child { border-bottom: none; }
    .settings-label { font-size: 13px; font-weight: 600; color: var(--text-secondary); }
    .clear-all-btn {
      background: transparent; border: 1px solid rgba(239,68,68,0.3); color: var(--red-light);
      padding: 6px 16px; border-radius: 8px; font-size: 12px; font-weight: 600;
      cursor: pointer; transition: all 0.2s; font-family: inherit;
    }
    .clear-all-btn:hover { background: rgba(239,68,68,0.08); border-color: var(--red); }

    /* ── Footer ── */
    footer { border-top: 1px solid var(--border); padding: 40px 24px; text-align: center; }
    .footer-inner { max-width: 1200px; margin: 0 auto; }
    .footer-brand { font-size: 14px; font-weight: 600; color: var(--text-secondary); margin-bottom: 8px; }
    .footer-disclaimer { font-size: 12px; color: var(--text-muted); max-width: 500px; margin: 0 auto; }

    /* ── Confirm Modal ── */
    .confirm-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 200; opacity: 0; pointer-events: none; transition: opacity 0.2s; }
    .confirm-backdrop.visible { opacity: 1; pointer-events: auto; }
    .confirm-modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%) scale(0.95); max-width: 340px; width: calc(100% - 32px); background: #1e1e2e; border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; z-index: 201; padding: 24px; opacity: 0; pointer-events: none; transition: opacity 0.2s, transform 0.2s; }
    .confirm-modal.visible { opacity: 1; pointer-events: auto; transform: translate(-50%,-50%) scale(1); }
    .confirm-msg { font-size: 15px; font-weight: 600; color: var(--text-primary); margin-bottom: 16px; text-align: center; }
    .confirm-actions { display: flex; gap: 10px; justify-content: center; }
    .confirm-cancel { background: transparent; border: 1px solid rgba(255,255,255,0.15); color: var(--text-secondary); padding: 8px 18px; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; font-family: inherit; transition: background 0.2s; }
    .confirm-cancel:hover { background: rgba(255,255,255,0.05); }
    .confirm-delete { background: var(--red); border: none; color: #fff; padding: 8px 18px; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; font-family: inherit; transition: background 0.2s; }
    .confirm-delete:hover { background: #dc2626; }

    /* ── Mobile ── */
    @media (max-width: 768px) {
      .nav-right { display: none; }
      .mobile-menu-btn { display: block; }
      .top-nav { height: 90px; }
      .top-nav-inner { padding: 0 1rem; flex-wrap: wrap; align-content: center; }
      .sports-tabs { position: static; transform: none; width: 100%; justify-content: center; gap: 2px; padding: 3px; margin: 0; order: 3; }
      .sport-tab { padding: 4px 10px; font-size: 11px; gap: 3px; }
      .soon-badge { font-size: 7px; padding: 1px 3px; }
      .nav-spacer { height: 100px !important; }
      main { padding: 0 12px 60px; }
      .page-header { padding: 0 12px; }
      .overview-grid { grid-template-columns: repeat(2, 1fr); gap: 8px; }
      .ov-card { padding: 14px 12px; }
      .ov-value { font-size: 22px; }
      .controls-row { gap: 8px; }
      .period-pill { padding: 5px 10px; font-size: 11px; }
      .calendar-card { padding: 16px; border-radius: 12px; }
      .cal-grid { gap: 4px; }
      .cal-cell .c-day { font-size: 9px; top: 2px; left: 4px; }
      .cal-cell .c-pl { font-size: 11px; }
      .cal-cell .c-tip { display: none !important; }
      .bet-card { padding: 12px 14px; }
      .bc-player { font-size: 14px; }
      .bc-profit { font-size: 16px; }
      .analytics-tabs { overflow-x: auto; -webkit-overflow-scrolling: touch; flex-wrap: nowrap; }
    }
    @media (max-width: 480px) {
      .brand-name { display: none; }
      .sports-tabs { gap: 1px; padding: 2px; }
      .sport-tab { padding: 4px 8px; font-size: 10px; }
      .soon-badge { font-size: 6px; padding: 0px 2px; }
      .period-pills { flex-wrap: wrap; }
      .controls-right { flex-wrap: wrap; }
      .cal-cell .c-day { display: none; }
    }
  </style>
</head>
<body>
  <div class="page-gradient"></div>

  <header class="top-nav">
    <div class="top-nav-inner">
      <div class="nav-brand">
        <a href="index.html" style="display:flex;align-items:center;text-decoration:none;">
          <span style="font-size:1.4rem;font-weight:800;color:#f0f0f0;letter-spacing:-0.02em;white-space:nowrap;">Edge Factor <span style="color:#dc2626;">Elite</span></span>
        </a>
      </div>
      <div class="sports-tabs" id="sports-tabs">
        <button class="sport-tab active" data-sport="nba">NBA</button>
        <button class="sport-tab" data-sport="nhl">NHL</button>
        <button class="sport-tab" data-sport="mlb">MLB <span class="soon-badge">Soon</span></button>
      </div>
      <div class="nav-right">
        <a href="results.html" class="nav-link">Results</a>
        <a href="mybets.html" class="nav-link active">My Bets<span class="bet-count-badge" id="nav-bet-count" style="display:none"></span></a>
        <a href="about.html" class="nav-link">About</a>
      </div>
      <button class="mobile-menu-btn" onclick="toggleMobileNav()" aria-label="Menu">&#9776;</button>
    </div>
  </header>

  <div class="mobile-nav-backdrop" id="mobile-nav-backdrop" onclick="closeMobileNav()"></div>
  <div class="mobile-nav-drawer" id="mobile-nav-drawer">
    <div class="mobile-drawer-links">
      <a href="dashboard.html"><span class="menu-icon">&#128200;</span> Projections</a>
      <a href="results.html"><span class="menu-icon">&#128202;</span> Results</a>
      <a href="mybets.html" class="active"><span class="menu-icon">&#127919;</span> My Bets <span class="bet-count-badge" id="mobile-bet-count" style="display:none"></span></a>
      <a href="about.html"><span class="menu-icon">&#8505;&#65039;</span> About</a>
    </div>
    <div class="mobile-drawer-auth" id="mobile-drawer-auth">
      <a href="login.html" class="mobile-drawer-login-btn">&#128100; Log In / Sign Up</a>
    </div>
  </div>

  <div class="nav-spacer"></div>

  <div class="page-header fade-section"><h1 class="page-title">My Bets</h1></div>

  <main>
    <!-- Overview -->
    <div class="overview-grid fade-section" id="overview-grid"></div>

    <!-- Controls -->
    <div class="controls-row fade-section">
      <div class="period-pills" id="period-pills">
        <button class="period-pill" data-period="today" onclick="setPeriod('today')">Today</button>
        <button class="period-pill" data-period="week" onclick="setPeriod('week')">This Week</button>
        <button class="period-pill" data-period="month" onclick="setPeriod('month')">This Month</button>
        <button class="period-pill active" data-period="all" onclick="setPeriod('all')">All Time</button>
      </div>
      <div class="controls-right">
        <div class="pill-toggle">
          <button class="pill-toggle-btn active" id="toggle-units" onclick="setDisplayMode('units')">Units</button>
          <button class="pill-toggle-btn" id="toggle-dollars" onclick="setDisplayMode('dollars')">Dollars</button>
        </div>
      </div>
    </div>

    <!-- Calendar -->
    <div class="calendar-card fade-section" id="calendar-section">
      <div class="cal-header">
        <button class="cal-nav" onclick="changeMonth(-1)">&#9664;</button>
        <span class="cal-month" id="cal-month"></span>
        <button class="cal-nav" onclick="changeMonth(1)">&#9654;</button>
      </div>
      <div class="cal-grid" id="cal-grid"></div>
      <div class="cal-summary" id="cal-summary"></div>
    </div>

    <!-- Day Detail -->
    <div class="day-section fade-section" id="day-section"></div>

    <!-- Analytics -->
    <div class="analytics-section fade-section" id="analytics-section">
      <div class="section-title">Analytics</div>
      <div class="analytics-tabs" id="analytics-tabs">
        <button class="analytics-tab active" data-tab="sport" onclick="setAnalyticsTab('sport')">By Sport</button>
        <button class="analytics-tab" data-tab="type" onclick="setAnalyticsTab('type')">By Type</button>
        <button class="analytics-tab" data-tab="book" onclick="setAnalyticsTab('book')">By Book</button>
      </div>
      <div class="analytics-card" id="analytics-card"></div>
    </div>

    <!-- Settings -->
    <div class="settings-section fade-section">
      <div class="section-title">Settings</div>
      <div class="settings-row">
        <span class="settings-label">Clear All Tracked Bets</span>
        <button class="clear-all-btn" onclick="confirmClearAll()">Clear All Data</button>
      </div>
    </div>
  </main>

  <footer>
    <div class="footer-inner">
      <div class="footer-brand">Edge Factor Elite</div>
      <div class="footer-disclaimer">For entertainment and informational purposes only. Please gamble responsibly.</div>
    </div>
  </footer>

  <div class="confirm-backdrop" id="confirm-backdrop" onclick="closeConfirm()"></div>
  <div class="confirm-modal" id="confirm-modal">
    <div class="confirm-msg" id="confirm-msg">Delete this bet?</div>
    <div class="confirm-actions">
      <button class="confirm-cancel" onclick="closeConfirm()">Cancel</button>
      <button class="confirm-delete" id="confirm-delete-btn" onclick="executeConfirm()">Delete</button>
    </div>
  </div>

  <script>
    // ── Mobile Nav ──
    function toggleMobileNav() {
      document.getElementById('mobile-nav-drawer').classList.toggle('open');
      document.getElementById('mobile-nav-backdrop').classList.toggle('open');
    }
    function closeMobileNav() {
      document.getElementById('mobile-nav-drawer').classList.remove('open');
      document.getElementById('mobile-nav-backdrop').classList.remove('open');
    }

    // ── User Menu (profile avatar dropdown) ──
    function toggleUserMenu() {
      const dropdown = document.getElementById('user-dropdown');
      if (dropdown) dropdown.classList.toggle('active');
    }
    document.addEventListener('click', (e) => {
      const dropdown = document.getElementById('user-dropdown');
      const avatar = document.querySelector('.user-avatar');
      if (dropdown && !dropdown.contains(e.target) && e.target !== avatar) {
        dropdown.classList.remove('active');
      }
    });

    // ── localStorage ──
    const LS_SETTINGS = 'efe_user_settings';
    const LS_BETS = 'efe_tracked_bets';
    function getBetSettings() { try { return JSON.parse(localStorage.getItem(LS_SETTINGS)) || {}; } catch { return {}; } }
    function saveBetSettings(s) { localStorage.setItem(LS_SETTINGS, JSON.stringify(s)); }
    function getTrackedBets() { try { return JSON.parse(localStorage.getItem(LS_BETS)) || []; } catch { return []; } }
    function saveTrackedBets(bets) { localStorage.setItem(LS_BETS, JSON.stringify(bets)); }
    function getUnitSize() { return getBetSettings().unit_size || 10; }
    function getDisplayMode() { return getBetSettings().display_mode || 'units'; }
    function calcProfit(odds, units) {
      const o = parseInt(odds); if (isNaN(o)) return 0;
      return o > 0 ? units * (o / 100) : units * (100 / Math.abs(o));
    }

    // ── State ──
    let currentPeriod = 'all';
    let currentSport = 'all';
    let analyticsTab = 'sport';
    const now = new Date();
    let calYear = now.getFullYear(), calMonth = now.getMonth();
    let selectedDate = now.toISOString().slice(0, 10);

    // ── Display Helpers ──
    function formatPL(u) {
      if (getDisplayMode() === 'dollars') { const d = u * getUnitSize(); return (d >= 0 ? '+$' : '-$') + Math.abs(d).toFixed(2); }
      return (u >= 0 ? '+' : '') + u.toFixed(2) + 'u';
    }
    function formatPLShort(u) {
      if (getDisplayMode() === 'dollars') { const d = u * getUnitSize(); return (d >= 0 ? '+$' : '-$') + Math.abs(d).toFixed(0); }
      return (u >= 0 ? '+' : '-') + Math.abs(u).toFixed(1) + 'u';
    }
    function formatDollar(u) { const d = u * getUnitSize(); return (d >= 0 ? '+$' : '-$') + Math.abs(d).toFixed(2); }

    function setDisplayMode(mode) {
      const s = getBetSettings(); s.display_mode = mode; saveBetSettings(s);
      document.getElementById('toggle-units').classList.toggle('active', mode === 'units');
      document.getElementById('toggle-dollars').classList.toggle('active', mode === 'dollars');
      renderAll();
    }
    function setPeriod(p) {
      currentPeriod = p;
      document.querySelectorAll('.period-pill').forEach(b => b.classList.toggle('active', b.dataset.period === p));
      renderAll();
    }
    function setAnalyticsTab(tab) {
      analyticsTab = tab;
      document.querySelectorAll('.analytics-tab').forEach(b => b.classList.toggle('active', b.dataset.tab === tab));
      renderAnalytics();
    }

    function getFilteredBets() {
      let bets = getTrackedBets();
      if (currentSport !== 'all') bets = bets.filter(b => (b.sport || '').toUpperCase() === currentSport.toUpperCase());
      if (currentPeriod === 'all') return bets;
      const td = new Date().toISOString().slice(0, 10);
      if (currentPeriod === 'today') return bets.filter(b => b.date === td);
      if (currentPeriod === 'week') { const w = new Date(); w.setDate(w.getDate() - 7); return bets.filter(b => b.date >= w.toISOString().slice(0, 10)); }
      if (currentPeriod === 'month') return bets.filter(b => b.date && b.date.startsWith(td.slice(0, 7)));
      return bets;
    }

    // Sport tabs
    document.querySelectorAll('#sports-tabs .sport-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        if (tab.dataset.sport === 'mlb') return;
        document.querySelectorAll('#sports-tabs .sport-tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        currentSport = tab.dataset.sport === 'nba' ? 'all' : tab.dataset.sport.toUpperCase();
        renderAll();
      });
    });

    // ── Overview ──
    function renderOverview() {
      const bets = getFilteredBets();
      const settled = bets.filter(b => b.status === 'win' || b.status === 'loss' || b.status === 'push');
      const wins = settled.filter(b => b.status === 'win').length;
      const losses = settled.filter(b => b.status === 'loss').length;
      const wr = settled.length > 0 ? (wins / settled.length * 100) : 0;
      const totalPL = bets.reduce((s, b) => s + (b.profit_units || 0), 0);
      const cls = totalPL > 0 ? 'green' : totalPL < 0 ? 'red' : '';
      const mode = getDisplayMode();
      const mainPL = mode === 'dollars' ? formatDollar(totalPL) : formatPL(totalPL);
      const altPL = mode === 'dollars' ? formatPL(totalPL) : formatDollar(totalPL);
      const negCls = totalPL < 0 ? ' negative' : '';

      document.getElementById('overview-grid').innerHTML = `
        <div class="ov-card profit${negCls}">
          <div class="ov-value ${cls}">${mainPL}</div>
          <div class="ov-label">${mode === 'dollars' ? '$ Profit' : 'Units Profit'}</div>
        </div>
        <div class="ov-card rate">
          <div class="ov-value">${wr.toFixed(1)}%</div>
          <div class="ov-label">Win Rate (${wins}-${losses})</div>
        </div>
        <div class="ov-card count">
          <div class="ov-value">${bets.length}</div>
          <div class="ov-label">Total Bets</div>
        </div>
        <div class="ov-card dollar${negCls}">
          <div class="ov-value ${cls}">${altPL}</div>
          <div class="ov-label">${mode === 'dollars' ? 'Units Profit' : '$ Profit'}</div>
        </div>`;
    }

    // ── Calendar ──
    function changeMonth(dir) {
      calMonth += dir;
      if (calMonth < 0) { calMonth = 11; calYear--; }
      if (calMonth > 11) { calMonth = 0; calYear++; }
      renderCalendar();
    }

    function renderCalendar() {
      const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
      document.getElementById('cal-month').textContent = months[calMonth] + ' ' + calYear;

      const allBets = getTrackedBets();
      const daily = {};
      allBets.forEach(b => {
        if (!b.date) return;
        if (!daily[b.date]) daily[b.date] = { pl: 0, w: 0, l: 0, p: 0, pending: 0 };
        if (b.profit_units != null) daily[b.date].pl += b.profit_units;
        if (b.status === 'win') daily[b.date].w++;
        else if (b.status === 'loss') daily[b.date].l++;
        else if (b.status === 'push') daily[b.date].p++;
        else daily[b.date].pending++;
      });

      const firstDay = new Date(calYear, calMonth, 1).getDay();
      const daysInMonth = new Date(calYear, calMonth + 1, 0).getDate();
      const todayStr = new Date().toISOString().slice(0, 10);

      let html = '';
      ['S','M','T','W','T','F','S'].forEach(d => { html += `<div class="cal-dow">${d}</div>`; });
      for (let i = 0; i < firstDay; i++) html += '<div class="cal-cell empty"></div>';

      let monthPL = 0, monthW = 0, monthL = 0;
      for (let d = 1; d <= daysInMonth; d++) {
        const ds = calYear + '-' + String(calMonth + 1).padStart(2, '0') + '-' + String(d).padStart(2, '0');
        const data = daily[ds];
        const hasBets = !!data;
        const isFuture = ds > todayStr;
        const isToday = ds === todayStr;
        const isSel = ds === selectedDate;
        let cls = '';

        if (hasBets) {
          monthPL += data.pl;
          monthW += data.w;
          monthL += data.l;
          if (data.w + data.l + data.p === 0 && data.pending > 0) cls = 'pending-day';
          else if (data.pl > 0) cls = data.pl >= 3 ? 'win-strong' : 'win';
          else if (data.pl < 0) cls = Math.abs(data.pl) >= 3 ? 'loss-strong' : 'loss';
          else if (data.w === 0 && data.l === 0) cls = 'pending-day';
          else cls = 'push-day';
        } else {
          cls = 'no-bets';
        }
        if (isFuture) cls += ' future';
        if (isToday) cls += ' today';
        if (isSel) cls += ' selected';

        const plHtml = hasBets ? `<span class="c-pl">${formatPLShort(data.pl)}</span>` : '';
        const dotHtml = hasBets ? '<span class="c-dot"></span>' : '';
        const tipHtml = hasBets ? `<div class="c-tip"><span class="c-tip-record">${data.w}-${data.l}${data.p ? '-' + data.p : ''}</span><span class="c-tip-pl" style="color:${data.pl >= 0 ? 'var(--accent-light)' : 'var(--red-light)'}">${formatPL(data.pl)}</span></div>` : '';

        html += `<div class="cal-cell ${cls}" onclick="selectDate('${ds}')"><span class="c-day">${d}</span>${plHtml}${dotHtml}${tipHtml}</div>`;
      }

      document.getElementById('cal-grid').innerHTML = html;

      // Summary
      const totalSettled = monthW + monthL;
      const wr = totalSettled > 0 ? (monthW / totalSettled * 100).toFixed(0) : 0;
      const plColor = monthPL >= 0 ? 'var(--accent-light)' : 'var(--red-light)';
      document.getElementById('cal-summary').innerHTML = `
        <div class="cal-summary-pl" style="color:${plColor}">${months[calMonth].slice(0, 3)} P/L: ${formatPL(monthPL)}</div>
        <div class="cal-winrate-bar">
          <div class="cal-winrate-track"><div class="cal-winrate-fill" style="width:${wr}%"></div></div>
          <span class="cal-winrate-label">${monthW}W-${monthL}L${totalSettled > 0 ? ' (' + wr + '%)' : ''}</span>
        </div>`;
    }

    function selectDate(ds) { selectedDate = ds; renderCalendar(); renderDayDetail(); }

    // ── Day Detail ──
    function renderDayDetail() {
      const container = document.getElementById('day-section');
      const allBets = getTrackedBets();

      // Empty state — no bets at all
      if (allBets.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">&#127919;</div>
            <div class="empty-title">Start Tracking Your Bets</div>
            <div class="empty-text">Click the &#9733; icon on any pick in the Dashboard to track your first bet.</div>
            <a href="dashboard.html" class="empty-cta">Go to Dashboard</a>
          </div>`;
        return;
      }

      if (!selectedDate) { container.innerHTML = ''; return; }

      const bets = allBets.filter(b => b.date === selectedDate);
      const dt = new Date(selectedDate + 'T12:00:00');
      const dateLabel = dt.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' });

      if (bets.length === 0) {
        container.innerHTML = `
          <div class="day-header"><span class="day-title">${dateLabel}</span></div>
          <div class="empty-day-msg">No bets tracked for this day</div>`;
        return;
      }

      const wins = bets.filter(b => b.status === 'win').length;
      const losses = bets.filter(b => b.status === 'loss').length;
      const pushes = bets.filter(b => b.status === 'push').length;
      const pending = bets.filter(b => b.status === 'pending').length;
      const dayPL = bets.reduce((s, b) => s + (b.profit_units || 0), 0);

      let recordParts = `${wins}W-${losses}L`;
      if (pushes > 0) recordParts += `-${pushes}P`;
      if (pending > 0) recordParts += ` (${pending} pending)`;
      const plCls = dayPL >= 0 ? 'green' : 'red';

      const cards = bets.map(b => {
        const icon = b.status === 'win' ? '<span style="color:var(--accent-light)">&#10003;</span>'
          : b.status === 'loss' ? '<span style="color:var(--red-light)">&#10007;</span>'
          : b.status === 'push' ? '<span style="color:var(--text-muted)">&#8860;</span>'
          : '<span class="pending-dot"></span>';

        const isProp = b.type === 'prop';
        const playerName = isProp ? b.player : (b.pick || b.type);
        const pickLine = isProp
          ? `${b.pick} ${b.line} ${(b.prop_type || '').toUpperCase()}`
          : `${b.pick} (${b.type.charAt(0).toUpperCase() + b.type.slice(1)})`;

        const oddsStr = b.odds > 0 ? '+' + b.odds : '' + b.odds;
        let profitStr, profitCls;
        if (b.status === 'pending') {
          profitStr = 'pending'; profitCls = 'yellow';
        } else if (b.profit_units != null) {
          profitStr = formatPL(b.profit_units);
          profitCls = b.profit_units >= 0 ? 'green' : 'red';
        } else {
          profitStr = '--'; profitCls = '';
        }
        const dollarStr = b.profit_units != null && b.status !== 'pending' ? formatDollar(b.profit_units) : '';
        const confStr = b.model_confidence ? b.model_confidence.toFixed(1) + '% conf' : '';
        const evStr = b.model_ev ? '+' + b.model_ev.toFixed(1) + '% EV' : '';
        const metaParts = [oddsStr + ' on ' + (b.book || '?'), b.units + ' unit' + (b.units !== 1 ? 's' : '')];
        if (confStr) metaParts.push(confStr);
        if (evStr) metaParts.push(evStr);

        return `<div class="bet-card ${b.status || 'pending'}">
          <button class="bc-delete" onclick="confirmDeleteBet('${b.id}')" title="Delete">&#10005;</button>
          <div class="bc-top">
            <div class="bc-left">
              <div class="bc-player-row"><span class="bc-icon">${icon}</span><span class="bc-player">${playerName}</span></div>
              <div class="bc-pick">${pickLine}<span class="bc-sep">&#183;</span>${b.game || ''}</div>
              <div class="bc-meta">${metaParts.map(p => '<span class="bc-meta-tag">' + p + '</span>').join('')}</div>
            </div>
            <div class="bc-right">
              <div class="bc-profit ${profitCls}">${profitStr}</div>
              ${dollarStr ? '<div class="bc-dollar">' + dollarStr + '</div>' : ''}
            </div>
          </div>
        </div>`;
      }).join('');

      container.innerHTML = `
        <div class="day-header">
          <span class="day-title">${dateLabel}</span>
          <span class="day-record-badge">${recordParts} <span class="drb-pl ${plCls}">${formatPL(dayPL)}</span></span>
        </div>
        ${cards}`;
    }

    // ── Delete ──
    let pendingDeleteId = null, pendingDeleteAction = null;
    function confirmDeleteBet(id) {
      pendingDeleteId = id; pendingDeleteAction = 'single';
      document.getElementById('confirm-msg').textContent = 'Delete this bet?';
      document.getElementById('confirm-backdrop').classList.add('visible');
      document.getElementById('confirm-modal').classList.add('visible');
    }
    function confirmClearAll() {
      pendingDeleteAction = 'all';
      document.getElementById('confirm-msg').textContent = 'Delete ALL tracked bets? This cannot be undone.';
      document.getElementById('confirm-backdrop').classList.add('visible');
      document.getElementById('confirm-modal').classList.add('visible');
    }
    function closeConfirm() {
      pendingDeleteId = null; pendingDeleteAction = null;
      document.getElementById('confirm-backdrop').classList.remove('visible');
      document.getElementById('confirm-modal').classList.remove('visible');
    }
    function executeConfirm() {
      if (pendingDeleteAction === 'single' && pendingDeleteId) saveTrackedBets(getTrackedBets().filter(b => b.id !== pendingDeleteId));
      else if (pendingDeleteAction === 'all') saveTrackedBets([]);
      closeConfirm(); renderAll();
    }

    // ── Analytics ──
    function renderAnalytics() {
      const bets = getFilteredBets();
      const el = document.getElementById('analytics-card');

      if (bets.length === 0) {
        el.innerHTML = '<div class="an-row"><span class="an-label" style="color:var(--text-muted)">No bet data yet</span></div>';
        return;
      }

      let groups;
      if (analyticsTab === 'sport') {
        const sports = [...new Set(bets.map(b => b.sport || 'NBA'))];
        groups = sports.map(s => [s, bets.filter(b => (b.sport || 'NBA') === s)]);
      } else if (analyticsTab === 'type') {
        const types = [['Props', 'prop'], ['Spread', 'spread'], ['Total', 'total'], ['ML', 'ml']];
        groups = types.map(([label, t]) => [label, bets.filter(b => b.type === t)]).filter(([, a]) => a.length > 0);
      } else {
        const books = [...new Set(bets.map(b => b.book || 'Other'))];
        groups = books.map(bk => [bk, bets.filter(b => (b.book || 'Other') === bk)]);
      }

      el.innerHTML = groups.map(([label, subset]) => {
        const w = subset.filter(b => b.status === 'win').length;
        const l = subset.filter(b => b.status === 'loss').length;
        const p = subset.filter(b => b.status === 'push').length;
        const settled = w + l + p;
        const wr = settled > 0 ? (w / (w + l) * 100) : 0;
        const pl = subset.reduce((s, b) => s + (b.profit_units || 0), 0);
        const plStr = formatPL(pl);
        const plCls = pl > 0 ? 'positive' : pl < 0 ? 'negative' : '';
        return `<div class="an-row">
          <span class="an-label">${label}</span>
          <span class="an-record">${w}-${l}${p ? '-' + p : ''}</span>
          <div class="an-bar-wrap">
            <div class="an-bar-track"><div class="an-bar-fill" style="width:${wr.toFixed(0)}%"></div></div>
            <span class="an-pct">${wr.toFixed(0)}%</span>
          </div>
          <span class="an-pl ${plCls}">${plStr}</span>
        </div>`;
      }).join('');
    }

    // ── Badge ──
    function updateBetCountBadges() {
      const pending = getTrackedBets().filter(b => b.status === 'pending').length;
      ['nav-bet-count', 'mobile-bet-count'].forEach(id => {
        const el = document.getElementById(id);
        if (!el) return;
        if (pending > 0) { el.textContent = pending; el.style.display = ''; }
        else el.style.display = 'none';
      });
    }

    // ── Render All ──
    function renderAll() { renderOverview(); renderCalendar(); renderDayDetail(); renderAnalytics(); updateBetCountBadges(); }

    // ── Init ──
    (function init() {
      const s = getBetSettings();
      const mode = s.display_mode || 'units';
      document.getElementById('toggle-units').classList.toggle('active', mode === 'units');
      document.getElementById('toggle-dollars').classList.toggle('active', mode === 'dollars');
      renderAll();
    })();
  </script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="auth.js"></script>
  <script>
    firebase.auth().onAuthStateChanged((user) => {
      if (!user) { window.location.replace('index.html'); return; }
    });
  </script>
</body>
</html>
